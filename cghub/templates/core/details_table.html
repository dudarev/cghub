{% load search_tags %}

{% if res %}
    {% if request.is_ajax %}
        {% comment %} This will be shown in popup {% endcomment %}
        <a href="{% url item_details analysis_id %}#raw-xml" class="raw-xml-link">Show metadata XML</a>
    {% else %}
        <h2 class="hidden">Details table:</h2>
    {% endif %}
    <table class="table table-bordered js-details-table" summary="details for file with analysis id = {{ analysis_id }}" id="main-content" tabindex="0">
        <caption class="hidden">returned file details</caption>
        {% details_table res %}
    </table>
    {% if request.is_ajax %}
        {% comment %} This will be shown in popup {% endcomment %}
        <a href="{% url item_details analysis_id %}#raw-xml" class="raw-xml-link">Show metadata XML</a>
    {% else %}
        <h2 id="raw-xml">Metadata XML:</h2>
        <form action="{% url metadata analysis_id %}" method="GET">
            {% csrf_token %}
            <div class="btn-toolbar">
                <div class="">
                    <a id="id-collapse-all-button" class="btn" tabindex="102">Collapse all<span class="hidden"> in raw xml</span></a>
                    <a id="id-expand-all-button" class="btn" tabindex="103">Expand all<span class="hidden"> in raw xml</span></a>
                    <input type="hidden" name="last_modified" value="{{ res.last_modified }}">
                    <input type="hidden" name="state" value="{{ res.state }}">
                    <button id="id-download-metadata" class="btn" tabindex="104">Download XML</button>
                </div>
            </div>
        </form>
        <div id="XMLHolder" class="XmlContainer" tabindex="105" title="raw xml"></div>
    {% endif %}
{% else %}
No data.
{% endif %}
