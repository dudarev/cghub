jQuery(function(e){"use strict";var t={};this.cghub!==undefined?t=this.cghub:this.cghub=t,t.cart={init:function(){t.cart.cacheElements(),t.cart.initFlexigrid(),t.cart.bindEvents()},cacheElements:function(){t.cart.$columnNumber=0,t.cart.$nextColumn,t.cart.$nextColumnWidth=0,t.cart.$searchTable=e("table.data-table"),t.cart.$downloadManifestXml=e(".cart-download-manifest"),t.cart.$downloadMetadataXml=e(".cart-download-metadata"),t.cart.$downloadMetadataTsv=e(".cart-download-summary"),t.cart.$removeBtn=e(".cart-remove"),t.cart.$clearBtn=e(".cart-clear")},bindEvents:function(){t.cart.$downloadManifestXml.on("click",t.cart.downloadManifest),t.cart.$downloadMetadataXml.on("click",t.cart.downloadMetadata),t.cart.$downloadMetadataTsv.on("click",t.cart.downloadSummary),t.cart.$removeBtn.on("click",t.cart.removeFromCart),t.cart.$clearBtn.on("click",t.cart.clearCart)},initFlexigrid:function(){t.cart.$searchTable.flexigrid({height:"auto",showToggleBtn:!1}),e(".flexigrid .bDiv tr").contextmenu(),e(".data-table").css("visibility","visible");var n=e(".bDiv table");n.wrap(e("<fieldset/>")),n.parent().prepend(e('<legend class="hidden">Select files to remove from cart:</legend>'))},removeFromCart:function(){var n=e(this),r=n.closest("form");t.selected.save();if(!t.selected.exists)return!1;r.append(e('<textarea name="ids" style="display: none;">'+t.selected.get_ids_list().join(" ")+"</textarea>")),r.attr("action",r.attr("action").replace(/\/[a-z_]+\/$/,"/remove/"))},clearCart:function(){var t=e(this),n=t.closest("form");n.attr("action",n.attr("action").replace(/\/[a-z_]+\/$/,"/clear/"))},downloadManifest:function(){var t=e(this),n=t.closest("form");n.attr("action",n.attr("action").replace(/\/[a-z_]+\/$/,"/manifest/"))},downloadMetadata:function(){var t=e(this),n=t.closest("form");n.attr("action",n.attr("action").replace(/\/[a-z_]+\/$/,"/metadata/"))},downloadSummary:function(){var t=e(this),n=t.closest("form");n.attr("action",n.attr("action").replace(/\/[a-z_]+\/$/,"/summary/"))}},t.cart.init()}),jQuery(function(e){"use strict";var t={};this.cghub!==undefined?t=this.cghub:this.cghub=t,t.selected={_storage_key:"selectedItems",exists:!1,items:{},init:function(){var n=sessionStorage.getItem(t.selected._storage_key);n!==null&&(t.selected.items=e.parseJSON(n),sessionStorage.setItem(t.selected._storage_key,"{}")),t.selected.count()},save:function(){var n=e('input[type="checkbox"][name="selected_files"]:checked');n.each(function(n,r){t.selected.add(e(r).val())});var n=e('input[type="checkbox"][name="selected_files"]:not(:checked)');n.each(function(n,r){delete t.selected.items[e(r).val()]}),sessionStorage.setItem(t.selected._storage_key,JSON.stringify(t.selected.items))},add:function(n){var r=e('input[type="checkbox"][value="'+n+'"]');r.length&&(t.selected.items[n]=r.data(),t.selected.exists=!0)},ids:function(){var e=[];for(var n in t.selected.items)e.push(n);return e},get_ids_list:function(){return sessionStorage.setItem(t.selected._storage_key,"{}"),t.selected.ids()},get_data_list:function(){var n=[];return e.each(t.selected.items,function(e,t){n.push(t)}),sessionStorage.setItem(t.selected._storage_key,"{}"),n},count:function(){var e=0;for(var n in t.selected.items)e+=1;return e>0?t.selected.exists=!0:t.selected.exists=!1,e}},t.selected.init(),t.table={clearSelectionTimeout:undefined,init:function(){t.table.cacheElements(),t.table.bindEvents(),t.table.$selectAllCheckbox.removeAttr("disabled"),t.table.repairSelection()},cacheElements:function(){t.table.$itemsPerPageLink=e(".items-per-page-label > a"),t.table.$pageLink=e(".pagination ul li a"),t.table.$selectAllCheckbox=e(".js-select-all"),t.table.$checkboxes=e(".data-table-checkbox"),t.table.$flexigrid=e(".flexigrid"),t.table.$tableContainer=t.table.$flexigrid.find(".bDiv"),t.table.$tableHeaderContainer=t.table.$flexigrid.find(".hDiv")},bindEvents:function(){t.table.activateItemDetailsLinks(),t.table.$itemsPerPageLink.unbind("click"),t.table.$itemsPerPageLink.on("click",t.selected.save),t.table.$pageLink.on("click",t.selected.save),t.table.$selectAllCheckbox.on("change",t.table.changeCheckboxes),t.table.$checkboxes.on("change",t.table.updateSelectAll),t.table.$checkboxes.on("focusin",t.table.tableCheckboxFocus),t.table.$checkboxes.on("focusout",t.table.tableCheckboxFocus),t.table.$flexigrid.on("keydown",t.table.arrowPress),t.table.$tableHeaderContainer.on("scroll",function(){t.table.$tableContainer.scrollLeft(t.table.$tableHeaderContainer.scrollLeft())})},activateItemDetailsLinks:function(){e(document).on("click",".bDiv tr",function(n){var r=e(n.target).find("input[name=selected_files]");if(n.target.name=="selected_files"||r.length)return;var i=e(this),s=e(i.attr("data-target")),o=!1;return s.on("shown",function(){o||s.find(".modal-body").load(i.attr("data-details-url")+"?ajax=1",function(e,n,r){n=="error"?s.find(".modal-body").html('There was an error loading data. Please contact admin: <a href="mailto:'+t.vars.supportEmail+'">'+t.vars.supportEmail+"</a>"):o=!0})}).on("show",function(){s.find(".modal-body").html("Loading ..."),s.find(".modal-label").html("Details for Analysis Id "+i.attr("data-analysis_id"))}).modal("show"),!1}),e(document).on("click",".js-details-popup",function(){var t=e(e(this).parents("ul").data("e").target).parents("td");return t.trigger("click"),!1}),e(document).on("click",".js-details-page",function(){var t=e(e(this).parents("ul").data("e").target).parents("tr");return window.open(t.attr("data-details-url"),"_blank"),window.focus(),!1})},changeCheckboxes:function(){t.table.$checkboxes.prop("checked",e(this).is(":checked"));return},updateSelectAll:function(){t.table.$selectAllCheckbox.prop("checked",t.table.$checkboxes.length==e(".data-table-checkbox:checked").length)},repairSelection:function(){var n=t.selected.ids();if(n.length){for(var r in n){var i=e(".data-table-checkbox[value="+n[r]+"]");i.length&&i.prop("checked",!0)}e("input.data-table-checkbox:checked").length==e("input.data-table-checkbox").length&&e(".js-select-all").prop("checked",!0)}},tableCheckboxFocus:function(n){n.type=="focusin"?e(this).parents("td").addClass("tdSelected"):n.type=="focusout"&&(e(this).parents("td").removeClass("tdSelected"),t.table.clearSelectionTimeout&&clearTimeout(t.table.clearSelectionTimeout),t.table.clearSelectionTimeout=setTimeout(function(){var t=e(".tdSelected");t.length==1&&!t.find("input").length&&t.removeClass("tdSelected")},500))},arrowPress:function(n){var r=n.which?n.which:n.keyCode;if(n.ctrlKey&&r==13){var i=e("td.tdSelected");return i.length&&(window.open(i.parents("tr").attr("data-details-url"),"_blank"),window.focus()),!1}if(!n.altKey)return;if(r==18)return!1;if(r==13)return e("td.tdSelected").click(),!1;if(e.inArray(r,[37,39,38,40])==-1)return;var s=e("td.tdSelected");s.length>1&&(s=s.eq(1));var o=s,u=s.parents("tr"),a=u.children().index(s),f=u;if(r==37)do o=e(o).prev();while(o.is("td")&&!e(o).is(":visible"));if(r==39)do o=e(o).next();while(o.is("td")&&!e(o).is(":visible"));if(r==38){f=e(f).prev();if(!f.is("tr"))return!1;o=f.find("td:nth-child("+(a+1)+")")}if(r==40){f=e(f).next();if(!f.is("tr"))return!1;o=f.find("td:nth-child("+(a+1)+")")}return o.is("td")?(e(".tdSelected").removeClass("tdSelected"),o.addClass("tdSelected"),o.parents("tr").find("input").focus(),t.table.scrollTableToCell(o),!1):!1},scrollTableToCell:function(n){var r=e(n).offset().left,i=r+e(n).width(),s=t.table.$flexigrid.offset().left,o=s+t.table.$flexigrid.width();i>o&&t.table.$tableContainer.scrollLeft(t.table.$tableContainer.scrollLeft()+i-o+50),r<s&&t.table.$tableContainer.scrollLeft(t.table.$tableContainer.scrollLeft()-s+r-50)}},t.table.init()});