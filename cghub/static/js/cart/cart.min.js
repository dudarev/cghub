jQuery(function(a){"use strict";var b={};void 0!==this.cghub?b=this.cghub:this.cghub=b,b.cart={init:function(){b.cart.cacheElements(),b.cart.initFlexigrid(),b.cart.bindEvents()},cacheElements:function(){b.cart.$columnNumber=0,b.cart.$nextColumn,b.cart.$nextColumnWidth=0,b.cart.$searchTable=a("table.data-table"),b.cart.$downloadFileBtn=a(".cart-download"),b.cart.$removeBtn=a(".cart-remove"),b.cart.$clearBtn=a(".cart-clear"),b.cart.$form=a("#cart-form"),b.cart.$cbCompressed=a(".js-compressed")},bindEvents:function(){b.cart.$downloadFileBtn.on("click",b.cart.downloadFile),b.cart.$removeBtn.on("click",b.cart.removeFromCart),b.cart.$clearBtn.on("click",b.cart.clearCart),b.cart.$form.length&&(b.cart.$form[0].onsubmit=b.cart.formSubmit),b.cart.compressedCheckbox()},initFlexigrid:function(){b.cart.$searchTable.flexigrid({height:"auto",showToggleBtn:!1}),a(".data-table").css("visibility","visible");var c=a(".bDiv table");c.wrap(a("<fieldset/>")),c.parent().prepend(a('<legend class="hidden">Select files to remove from cart:</legend>'))},formSubmit:function(){return console.log(a(this).attr("action")),-1!=a(this).attr("action").indexOf("action")?!1:void 0},removeFromCart:function(){var c=a(this),d=c.closest("form");return d.attr("action",d.attr("action").replace("?gzip=true","")),b.selected.save(),b.selected.exists?(d.append(a('<textarea name="ids" style="display: none;">'+b.selected.get_ids_list().join(" ")+"</textarea>")),d.attr("action",d.attr("action").replace(/\/[a-z_]+\/$/,"/remove/")),void 0):!1},clearCart:function(){var b=a(this),c=b.closest("form");c.attr("action",c.attr("action").replace("?gzip=true","")),c.attr("action",c.attr("action").replace(/\/[a-z_]+\/$/,"/clear/"))},compressedCheckbox:function(){var c=sessionStorage.getItem("download-compressed");null===c&&(c="false"),b.cart.$cbCompressed.prop("checked","true"==c),b.cart.$cbCompressed.on("change",function(){var c=a(this).prop("checked");sessionStorage.setItem("download-compressed",c),b.cart.$cbCompressed.prop("checked",c)})},downloadFile:function(){var c=a(this),d=c.closest("form");d.attr("action",d.attr("action").replace("?gzip=true",""));var e="/"+c.data("download")+"/";return b.cart.$cbCompressed.prop("checked")?(d.attr("action",d.attr("action").replace(/\/[a-z_]+\/$/,e+"?gzip=true")),d.trigger("submit"),c.parent().trigger("click"),!1):(d.attr("action",d.attr("action").replace(/\/[a-z_]+\/$/,e)),void 0)}},b.cart.init()}),!function(a){"use strict";function b(){a(".context-menu").css("display","none").data("e",void 0)}var c=function(c){a(c).on("click.context-menu.data-api",this.show),a(c).on("keydown.context-menu.data-api",this.show),a("html").on("click.context-menu.data-api",b),a(".dropdown-close").on("focus.context-menu.data-api",b)};c.prototype={constructor:c,show:function(c){var d=a(this);if(!d.is(".disabled, :disabled")){b();var e=0,f=0;if(c.clientX)e=c.clientX,f=c.clientY;else{if(c.ctrlKey||c.altKey)return;var g=a(c.target).offset(),h=c.which?c.which:c.keyCode;if(13!=h&&32!=h)return b(),void 0;e=g.left-a(window).scrollLeft(),f=g.top+a(c.target).outerHeight()-a(window).scrollTop()}var i=a(d.data("context-menu")),j="menu-item-additional",k=a(c.target).parents("tr").data("menu").split(",");return a("."+j).remove(),a.each(k,function(b,c){var d=c.split("|");2==d.length&&i.find(".dropdown-bottom").before(a('<li class="'+j+'"><a href="'+d[1]+'" target="_blank" tabindex="55">'+d[0]+"</a></li>"))}),i.data("e",c).css("position","fixed").css("left",e).css("top",f).css("display","block"),i.find("li").first().find("a").focus(),!1}}},a.fn.contextmenu=function(){return this.each(function(){var d=a(this);d.data("context-menu-obj")||(d.data("context-menu-obj",new c(this)),a(document).on("keydown","#table-context-menu",function(a){var c=a.which?a.which:a.keyCode;return 27==c?(b(),!1):void 0}))})},a.fn.contextmenu.Constructor=c}(jQuery),jQuery(function(a){"use strict";var b={};void 0!==this.cghub?b=this.cghub:this.cghub=b,b.selected={_storage_key:"selectedItems",exists:!1,items:{},init:function(){var c=sessionStorage.getItem(b.selected._storage_key);null!==c&&(b.selected.items=a.parseJSON(c),sessionStorage.setItem(b.selected._storage_key,"{}")),b.selected.count()},save:function(){var c=a('input[type="checkbox"][name="selected_files"]:checked');c.each(function(c,d){b.selected.add(a(d).val())});var c=a('input[type="checkbox"][name="selected_files"]:not(:checked)');c.each(function(c,d){delete b.selected.items[a(d).val()]}),sessionStorage.setItem(b.selected._storage_key,JSON.stringify(b.selected.items))},add:function(c){var d=a('input[type="checkbox"][value="'+c+'"]');d.length&&(b.selected.items[c]=d.data(),b.selected.exists=!0)},ids:function(){var a=[];for(var c in b.selected.items)a.push(c);return a},get_ids_list:function(){return sessionStorage.setItem(b.selected._storage_key,"{}"),b.selected.ids()},get_data_list:function(){var c=[];return a.each(b.selected.items,function(a,b){c.push(b)}),sessionStorage.setItem(b.selected._storage_key,"{}"),c},count:function(){var a=0;for(var c in b.selected.items)a+=1;return b.selected.exists=a>0?!0:!1,a}},b.selected.init(),b.table={clearSelectionTimeout:void 0,init:function(){b.table.cacheElements(),b.table.bindEvents(),b.table.$selectAllCheckbox.removeAttr("disabled"),b.table.repairSelection()},cacheElements:function(){b.table.$itemsPerPageLink=a(".items-per-page-label > a"),b.table.$pageLink=a(".pagination ul li a"),b.table.$selectAllCheckbox=a(".js-select-all"),b.table.$checkboxes=a(".data-table-checkbox"),b.table.$flexigrid=a(".flexigrid"),b.table.$tableContainer=b.table.$flexigrid.find(".bDiv"),b.table.$tableHeaderContainer=b.table.$flexigrid.find(".hDiv")},bindEvents:function(){b.table.activateItemDetailsLinks(),b.table.$itemsPerPageLink.on("click",b.selected.save),b.table.$pageLink.on("click",b.selected.save),b.table.$selectAllCheckbox.on("change",b.table.changeCheckboxes),b.table.$checkboxes.on("change",b.table.updateSelectAll),b.table.$checkboxes.on("focusin",b.table.tableCheckboxFocus),b.table.$checkboxes.on("focusout",b.table.tableCheckboxFocus),b.table.$flexigrid.on("keydown",b.table.arrowPress),b.table.$tableHeaderContainer.on("scroll",function(){b.table.$tableContainer.scrollLeft(b.table.$tableHeaderContainer.scrollLeft())}),b.table.$flexigrid.find(".details-link").contextmenu()},showDetailsPopup:function(c){var d=a(c.attr("data-target")),e=!1;return d.on("shown",function(){e||d.find(".modal-body").load(c.attr("data-details-url")+"?ajax=1",function(a,c){"error"==c?d.find(".modal-body").html('There was an error loading data. Please contact admin: <a href="mailto:'+b.vars.supportEmail+'">'+b.vars.supportEmail+"</a>"):e=!0})}).on("show",function(){d.find(".modal-body").html("Loading ..."),d.find(".modal-label").html("Details for Analysis Id "+c.parents("tr").attr("data-analysis_id"))}).modal("show"),!1},activateItemDetailsLinks:function(){a(document).on("click",".js-details-popup",function(){var c=a(a(this).parents("ul").data("e").target).parents("td");return b.table.showDetailsPopup(c),!1}),a(document).on("keydown",".js-details-popup",function(c){var d=c.which?c.which:c.keyCode;if(13==d||32==d){var e=a(a(c.target).parents("ul").data("e").target);return b.table.showDetailsPopup(e),!1}}),a.browser.msie&&a(document).on("click",".js-cart-add-item-button",function(){var b=a(this).parent().attr("action"),c=document.createElement("form");return c.action=b,c.method="POST",c.id="ie-form",document.body.appendChild(c),c.submit(),document.body.removeChild(c),!1})},changeCheckboxes:function(){b.table.$checkboxes.prop("checked",a(this).is(":checked"))},updateSelectAll:function(){b.table.$selectAllCheckbox.prop("checked",b.table.$checkboxes.length==a(".data-table-checkbox:checked").length)},repairSelection:function(){var c=b.selected.ids();if(c.length){for(var d in c){var e=a(".data-table-checkbox[value="+c[d]+"]");e.length&&e.prop("checked",!0)}a("input.data-table-checkbox:checked").length==a("input.data-table-checkbox").length&&a(".js-select-all").prop("checked",!0)}},tableCheckboxFocus:function(c){"focusin"==c.type?a(this).parents("td").addClass("tdSelected"):"focusout"==c.type&&(a(this).parents("td").removeClass("tdSelected"),b.table.clearSelectionTimeout&&clearTimeout(b.table.clearSelectionTimeout),b.table.clearSelectionTimeout=setTimeout(function(){var b=a(".tdSelected");1!=b.length||b.find("input").length||b.removeClass("tdSelected")},500))},arrowPress:function(c){var d=c.which?c.which:c.keyCode;if(c.ctrlKey&&13==d){var e=a("td.tdSelected");return e.length&&(window.open(e.parents("tr").find(".details-link").attr("data-details-url"),"_blank"),window.focus()),!1}if(c.altKey){if(18==d)return!1;if(13==d){var f=a("td.tdSelected").parents("tr").find(".details-link");return b.table.showDetailsPopup(f),!1}if(-1!=a.inArray(d,[37,39,38,40])){var g=a("td.tdSelected");g.length>1&&(g=g.eq(1));var h=g,i=g.parents("tr"),j=i.children().index(g),k=i;if(37==d)do h=a(h).prev();while(h.is("td")&&!a(h).is(":visible"));if(39==d)do h=a(h).next();while(h.is("td")&&!a(h).is(":visible"));if(38==d){if(k=a(k).prev(),!k.is("tr"))return!1;h=k.find("td:nth-child("+(j+1)+")")}if(40==d){if(k=a(k).next(),!k.is("tr"))return!1;h=k.find("td:nth-child("+(j+1)+")")}return h.is("td")?(a(".tdSelected").removeClass("tdSelected"),h.addClass("tdSelected"),h.parents("tr").find("input").focus(),b.table.scrollTableToCell(h),!1):!1}}},scrollTableToCell:function(c){var d=a(c).offset().left,e=d+a(c).width(),f=b.table.$flexigrid.offset().left,g=f+b.table.$flexigrid.width();e>g&&b.table.$tableContainer.scrollLeft(b.table.$tableContainer.scrollLeft()+e-g+50),f>d&&b.table.$tableContainer.scrollLeft(b.table.$tableContainer.scrollLeft()-f+d-50)}},b.table.init()});