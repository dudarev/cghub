jQuery(function(e){"use strict";var t={};this.cghub!==undefined?t=this.cghub:this.cghub=t,t.search={init:function(){t.search.cacheElements(),t.search.bindEvents(),t.search.initFlexigrid(),t.search.initDdcl(),t.search.updateCheckboxes(),t.search.updateDate()},cacheElements:function(){t.search.$searchTable=e("table.data-table"),t.search.$addFilesForm=e("form#id_add_files_form"),t.search.$applyFiltersButton=e("button#id_apply_filters"),t.search.$selectAllLink=e(".select-all"),t.search.$deselectAllLink=e(".clear-all"),t.search.$filterSelects=e("select.filter-select")},bindEvents:function(){t.search.$addFilesForm.on("submit",t.search.addFilesFormSubmit),t.search.$applyFiltersButton.on("click",t.search.applyFilters)},initFlexigrid:function(){t.search.$searchTable.flexigrid({height:"auto"})},initDdcl:function(){for(var n=t.search.$filterSelects.length-1;n>=0;n--){var r=t.search.$filterSelects[n];e(r).attr("section")=="last_modified"?e(r).dropdownchecklist({width:142}):(e(r).dropdownchecklist({firstItemChecksAll:!0,width:142,textFormatFunction:t.search.ddclTextFormatFunction,onComplete:t.search.ddclOnComplete}),e(r).next().find(".ui-dropdownchecklist-selector").click(function(){e(this).css("height","18px"),e(this).find(".ui-dropdownchecklist-text").html("selecting...").css({color:"#08c"})})),n==t.search.$filterSelects.length-1&&e(".sidebar-filters").show()}},ddclTextFormatFunction:function(e){var t=e.filter(":selected").size();return t==0?"Please select":"selecting..."},ddclOnComplete:function(t){var n="",r=0,i="#333";e(t).next().next().find(".ui-dropdownchecklist-item:has(input:checked)").each(function(t,i){n+=e(i).find("label").html()+"<br>",r++}),r==0&&(r=1,n="Please select",i="grey"),n.indexOf("(all)")!=-1&&(r=1,n="All"),e(t).next().find(".ui-dropdownchecklist-selector").css("height",r*19+"px"),e(t).next().find(".ui-dropdownchecklist-text").html(n).css({color:i})},addFilesFormSubmit:function(){var t={},n=e('input[type="checkbox"][name="selected_files"]:checked');return n.each(function(n,r){var i=e(r).data();t[i.analysis_id]=i}),e.ajax({data:e(this).serialize()+"&attributes="+JSON.stringify(t),type:e(this).attr("method"),dataType:"json",url:e(this).attr("action"),success:function(e){window.location.href=e.redirect}}),!1},updateCheckboxes:function(){var t=e(".filter-category"),n=URI.parseQuery(window.location.search);t.each(function(t,r){var i=e(this).attr("data-filter");if(i in n){var s=n[i];s=s.replace(/[)(]/g,""),s=s.split(" OR ");var o=e(this).find(":checkbox");o.each(function(t,n){e.inArray(e(this).attr("data-value"),s)<0?e(this).attr("checked",!1):e(this).attr("checked","checked")})}})},updateDate:function(){var t=URI.parseQuery(window.location.search),n=t.last_modified;n.search("1DAY")>0&&e("#id_date_today").attr("checked","checked"),n.search("7DAY")>0&&e("#id_date_week").attr("checked","checked"),n.search("1MONTH")>0&&e("#id_date_month").attr("checked","checked"),n.search("1YEAR")>0&&e("#id_date_year").attr("checked","checked")},applyFilters:function(){var t=URI(location.href),n=URI.parseQuery(window.location.search),r=!1,i=e(".filter-category");i.each(function(t,i){var s=e(this).attr("data-filter"),o=e(this).find(":checkbox"),u=!0,a="";o.each(function(t,n){e(this).attr("checked")=="checked"?a==""?a=e(this).attr("data-value"):a+=" OR "+e(this).attr("data-value"):u=!1}),!u&&a!=""&&(a="("+a+")",n[s]=a),u&&delete n[s],a==""&&(alert("Select some values."),r=!0)});var s=e(".filter-date").find(":radio"),o="";s.each(function(t,n){e(this).attr("checked")=="checked"&&(o=e(this).attr("data-value"))}),o!=""?n.last_modified=o:delete n.last_modified,t=t.search(n),r||(window.location.href=t)}},t.search.init()});