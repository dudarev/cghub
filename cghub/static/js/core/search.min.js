jQuery(function(e){"use strict";var t={};this.cghub!==undefined?t=this.cghub:this.cghub=t,t.search={init:function(){t.search.cacheElements(),t.search.bindEvents(),t.search.initFilterAccordions(),t.search.updateCheckboxes(),t.search.updateDate()},cacheElements:function(){t.search.$columnNumber=0,t.search.$nextColumn,t.search.$nextColumnWidth=0,t.search.$searchTable=e("table.data-table"),t.search.$addFilesForm=e("form#id_add_files_form"),t.search.$applyFiltersButton=e("button#id_apply_filters"),t.search.$selectAllLink=e(".select-all"),t.search.$deselectAllLink=e(".deselect-all")},bindEvents:function(){var n=e("#id_add_files_form > div.CRC");n.children().each(function(n,r){e(r).children().mousedown(function(r){t.search.nextColumn=e(e("table.data-table").find("thead > tr").children()[n+1]),t.search.nextColumnWidth=t.search.nextColumn.width()}),e(r).children().mouseup(function(e){t.search.columnNumber=n+1})}),t.search.$addFilesForm.on("submit",t.search.addFilesFormSubmit),t.search.$applyFiltersButton.on("click",t.search.applyFilters),t.search.$selectAllLink.on("click",t.search.selectAllFilterValues),t.search.$deselectAllLink.on("click",t.search.deselectAllFilterValues),e(window).unload(t.search.storeOpenedFilters),e(window).load(t.search.reStoreOpenedFilters)},storeOpenedFilters:function(){var t=sessionStorage;e(".filter-accordion-content").each(function(n,r){t.setItem(e(r).children().attr("data-filter"),e(r).css("display"))})},reStoreOpenedFilters:function(){var n=sessionStorage;e(".filter-accordion-content").each(function(r,i){var s=n.getItem(e(i).children().attr("data-filter"));s=="block"&&t.search.openFilterSection(e(i).parent())})},adjustColumns:function(){var n=t.search.columnNumber,r=0,i=e("table.data-table").find("thead > tr").children();t.search.nextColumn.width(t.search.nextColumnWidth),e("#id_add_files_form > div.CRC").children().each(function(t,n){r+=e(i[t]).width(),e(n).css("left",r+2+"px")})},addFilesFormSubmit:function(){var t={},n=e('input[type="checkbox"][name="selected_files"]:checked');return n.each(function(n,r){var i=e(r).data();t[i.analysis_id]=i}),e.ajax({data:e(this).serialize()+"&attributes="+JSON.stringify(t),type:e(this).attr("method"),dataType:"json",url:e(this).attr("action"),success:function(e){window.location.href=e.redirect}}),!1},updateCheckboxes:function(){var t=e(".filter-category"),n=URI.parseQuery(window.location.search);t.each(function(t,r){var i=e(this).attr("data-filter");if(i in n){var s=n[i];s=s.replace(/[)(]/g,""),s=s.split(" OR ");var o=e(this).find(":checkbox");o.each(function(t,n){e.inArray(e(this).attr("data-value"),s)<0?e(this).attr("checked",!1):e(this).attr("checked","checked")})}})},updateDate:function(){var t=URI.parseQuery(window.location.search),n=t.last_modified;n.search("1DAY")>0&&e("#id_date_today").attr("checked","checked"),n.search("7DAY")>0&&e("#id_date_week").attr("checked","checked"),n.search("1MONTH")>0&&e("#id_date_month").attr("checked","checked"),n.search("1YEAR")>0&&e("#id_date_year").attr("checked","checked")},applyFilters:function(){var t=URI(location.href),n=URI.parseQuery(window.location.search),r=!1,i=e(".filter-category");i.each(function(t,i){var s=e(this).attr("data-filter"),o=e(this).find(":checkbox"),u=!0,a="";o.each(function(t,n){e(this).attr("checked")=="checked"?a==""?a=e(this).attr("data-value"):a+=" OR "+e(this).attr("data-value"):u=!1}),!u&&a!=""&&(a="("+a+")",n[s]=a),u&&delete n[s],a==""&&(alert("Select some values."),r=!0)});var s=e(".filter-date").find(":radio"),o="";s.each(function(t,n){e(this).attr("checked")=="checked"&&(o=e(this).attr("data-value"))}),o!=""?n.last_modified=o:delete n.last_modified,t=t.search(n),r||(window.location.href=t)},selectAllFilterValues:function(){var t=e(this).parent().parent().find(":checkbox");return t.each(function(t,n){e(this).attr("checked","checked")}),!1},deselectAllFilterValues:function(){var t=e(this).parent().parent().find(":checkbox");return t.each(function(t,n){e(this).attr("checked",!1)}),!1},initFilterAccordions:function(){var n=e.find(".filter-accordion");for(var r=0;r<n.length;r++){var i=e(n[r]),s=i.children(".filter-accordion-header");s.bind("click",function(){t.search.openFilterSection(e(this).parent())})}},openFilterSection:function(e){e.find(".filter-accordion-content").slideToggle(),e.find(".filter-accordion-header").children().toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s")}},t.search.init()});