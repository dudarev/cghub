jQuery(function(a){"use strict";var b={};this.cghub!==undefined?b=this.cghub:this.cghub=b,b.search={init:function(){b.search.cacheElements(),b.search.bindEvents(),b.search.initFilterAccordions(),b.search.updateCheckboxes(),b.search.updateDate()},cacheElements:function(){b.search.$columnNumber=0,b.search.$nextColumn,b.search.$nextColumnWidth=0,b.search.$searchTable=a("table.data-table"),b.search.$addFilesForm=a("form#id_add_files_form"),b.search.$applyFiltersButton=a("button#id_apply_filters"),b.search.$selectAllLink=a(".select-all"),b.search.$deselectAllLink=a(".clear-all")},bindEvents:function(){var c=a("#id_add_files_form > div.CRC");c.children().each(function(c,d){a(d).children().mousedown(function(d){b.search.nextColumn=a(a("table.data-table").find("thead > tr").children()[c+1]),b.search.nextColumnWidth=b.search.nextColumn.width()}),a(d).children().mouseup(function(a){b.search.columnNumber=c+1})}),b.search.$addFilesForm.on("submit",b.search.addFilesFormSubmit),b.search.$applyFiltersButton.on("click",b.search.applyFilters),b.search.$selectAllLink.on("click",b.search.selectAllFilterValues),b.search.$deselectAllLink.on("click",b.search.deselectAllFilterValues),a(window).unload(b.search.storeOpenedFilters),a(window).load(b.search.reStoreOpenedFilters)},storeOpenedFilters:function(){var b=sessionStorage;a(".filter-accordion-content").each(function(c,d){b.setItem(a(d).children().attr("data-filter"),a(d).css("display"))})},reStoreOpenedFilters:function(){var c=sessionStorage;a(".filter-accordion-content").each(function(d,e){var f=c.getItem(a(e).children().attr("data-filter"));f=="block"&&b.search.openFilterSection(a(e).parent())})},adjustColumns:function(){var c=b.search.columnNumber,d=0,e=a("table.data-table").find("thead > tr").children();b.search.nextColumn.width(b.search.nextColumnWidth),a("#id_add_files_form > div.CRC").children().each(function(b,c){d+=a(e[b]).width(),a(c).css("left",d+2+"px")})},addFilesFormSubmit:function(){var b={},c=a('input[type="checkbox"][name="selected_files"]:checked');return c.each(function(c,d){var e=a(d).data();b[e.analysis_id]=e}),a.ajax({data:a(this).serialize()+"&attributes="+JSON.stringify(b),type:a(this).attr("method"),dataType:"json",url:a(this).attr("action"),success:function(a){window.location.href=a.redirect}}),!1},updateCheckboxes:function(){var b=a(".filter-category"),c=URI.parseQuery(window.location.search);b.each(function(b,d){var e=a(this).attr("data-filter");if(e in c){var f=c[e];f=f.replace(/[)(]/g,""),f=f.split(" OR ");var g=a(this).find(":checkbox");g.each(function(b,c){a.inArray(a(this).attr("data-value"),f)<0?a(this).attr("checked",!1):a(this).attr("checked","checked")})}})},updateDate:function(){var b=URI.parseQuery(window.location.search),c=b.last_modified;c.search("1DAY")>0&&a("#id_date_today").attr("checked","checked"),c.search("7DAY")>0&&a("#id_date_week").attr("checked","checked"),c.search("1MONTH")>0&&a("#id_date_month").attr("checked","checked"),c.search("1YEAR")>0&&a("#id_date_year").attr("checked","checked")},applyFilters:function(){var b=URI(location.href),c=URI.parseQuery(window.location.search),d=!1,e=a(".filter-category");e.each(function(b,e){var f=a(this).attr("data-filter"),g=a(this).find(":checkbox"),h=!0,i="";g.each(function(b,c){a(this).attr("checked")=="checked"?i==""?i=a(this).attr("data-value"):i+=" OR "+a(this).attr("data-value"):h=!1}),!h&&i!=""&&(i="("+i+")",c[f]=i),h&&delete c[f],i==""&&(alert("Select some values."),d=!0)});var f=a(".filter-date").find(":radio"),g="";f.each(function(b,c){a(this).attr("checked")=="checked"&&(g=a(this).attr("data-value"))}),g!=""?c.last_modified=g:delete c.last_modified,b=b.search(c),d||(window.location.href=b)},selectAllFilterValues:function(){var b=a(this).parent().parent().find(":checkbox");return b.each(function(b,c){a(this).attr("checked","checked")}),!1},deselectAllFilterValues:function(){var b=a(this).parent().parent().find(":checkbox");return b.each(function(b,c){a(this).attr("checked",!1)}),!1},initFilterAccordions:function(){var c=a.find(".filter-accordion");for(var d=0;d<c.length;d++){var e=a(c[d]),f=e.children(".filter-accordion-header");f.bind("click",function(){b.search.openFilterSection(a(this).parent())})}},openFilterSection:function(a){a.find(".filter-accordion-content").slideToggle(),a.find(".filter-accordion-header").children().toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s")}},b.search.init()});